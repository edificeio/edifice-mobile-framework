name: Sync phrase-translations

on:
  push:
    branches:
      - dev/1.11.0

jobs:
  sync-branch:
    name: Sync phrase-translations
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 16
      - uses: connor-baer/action-sync-branch@main
        with:
          branch: phrase-translations
          token: ${{ secrets.PHRASE_TRANSLATIONS }}
          force: true
      - name: Send Slack notification on failure
        run: |
        curl -X POST -H 'Content-type: application/json' \
          --data '{"text":"<!channel> :exclamation: Workflow *'"$GITHUB_WORKFLOW"'* failed for commit *'"$GITHUB_SHA"'* in *'"$GITHUB_REPOSITORY"'*. Workflow run URL: *'"$GITHUB_SERVER_URL/$GITHUB_REPOSITORY/actions/runs/$GITHUB_RUN_ID"'*"}' \
          ${{ secrets.SLACK_MONITOR_MOBILE_URL }}
